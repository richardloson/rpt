<!-- Usa el mismo código anterior -->
<!-- Agrega este botón después de la tabla: -->
<button class="boton" onclick="exportarPDF()">Exportar a PDF</button>

<!-- Y pega este SCRIPT justo antes de cerrar el </body>: -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
<script>
  function exportarPDF() {
    const cliente = document.getElementById("cliente").value || "cliente";
    const fechaInicio = document.getElementById("fechaInicio").value || "fecha";
    const nombreArchivo = `CAL_${cliente.replace(/\s+/g, '_')}_${fechaInicio.replace(/-/g, '')}.pdf`;

    // Crear una copia temporal del contenido para exportar limpio
    const contenedor = document.createElement("div");
    contenedor.style.fontFamily = "Arial, sans-serif";
    contenedor.style.padding = "20px";
    contenedor.innerHTML = `
      <h2 style="text-align:center;">Calendario de Servicios</h2>
      <p><strong>Cliente:</strong> ${cliente}</p>
      <p><strong>Dirección:</strong> ${document.getElementById("direccion").value}</p>
      <p><strong>Fecha de inicio:</strong> ${fechaInicio}</p>
      <table style="width:100%; border-collapse: collapse; font-size:10px;">
        <thead>
          <tr style="background:#e5e7eb;">
            <th style="border:1px solid #ccc; padding:4px;">Servicio</th>
            <th style="border:1px solid #ccc; padding:4px;">Fecha</th>
            <th style="border:1px solid #ccc; padding:4px;">Frecuencia</th>
          </tr>
        </thead>
        <tbody>
          ${Array.from(document.querySelectorAll("#resultados tbody tr")).map(tr => `
            <tr>
              ${Array.from(tr.children).map(td => `<td style="border:1px solid #ccc; padding:4px;">${td.textContent}</td>`).join("")}
            </tr>
          `).join("")}
        </tbody>
      </table>
    `;

    html2pdf()
      .set({
        margin: 5,
        filename: nombreArchivo,
        html2canvas: { scale: 1.2 },
        jsPDF: { unit: "mm", format: "a4", orientation: "portrait" }
      })
      .from(contenedor)
      .save();
  }
</script>